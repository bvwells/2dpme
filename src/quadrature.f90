module quadrature

   implicit none

contains

   subroutine triquad(w, coeffs, order)

      use precision

      implicit none
      !------------------------------------------------------------------------------
      integer, intent(IN) :: order
      real(kind=DP), intent(INOUT), dimension(1:order, 1:2) :: coeffs
      real(kind=DP), intent(INOUT), dimension(1:order) :: w
      !------------------------------------------------------------------------------

      if (order == 6) then
         ! integrates polynominals of degree 4 exactly.
         w(1) = 0.109951743655322d0; w(2) = 0.109951743655322d0
         w(3) = 0.109951743655322d0; w(4) = 0.223381589678011d0
         w(5) = 0.223381589678011d0; w(6) = 0.223381589678011d0
         coeffs(1, 1) = 0.816847572980459d0; coeffs(1, 2) = 0.091576213509771d0
         coeffs(2, 1) = 0.091576213509771d0; coeffs(2, 2) = 0.816847572980459d0
         coeffs(3, 1) = 0.091576213509771d0; coeffs(3, 2) = 0.091576213509771d0
         coeffs(4, 1) = 0.108103018168070d0; coeffs(4, 2) = 0.445948490915965d0
         coeffs(5, 1) = 0.445948490915965d0; coeffs(5, 2) = 0.108103018168070d0
         coeffs(6, 1) = 0.445948490915965d0; coeffs(6, 2) = 0.445948490915965d0
      elseif (order == 13) then
         ! integrates polynominals of degree 7 exactly.
         w(1) = -0.149570044467670d0; w(2) = 0.175615257433204d0
         w(3) = 0.175615257433204d0; w(4) = 0.175615257433204d0
         w(5) = 0.053347235608839d0; w(6) = 0.053347235608839d0
         w(7) = 0.053347235608839d0; w(8) = 0.077113760890257d0
         w(9) = 0.077113760890257d0; w(10) = 0.077113760890257d0
         w(11) = 0.077113760890257d0; w(12) = 0.077113760890257d0
         w(13) = 0.077113760890257d0; 
         coeffs(1, 1) = 0.333333333333333d0; coeffs(1, 2) = 0.333333333333333d0
         coeffs(2, 1) = 0.479308067841923d0; coeffs(2, 2) = 0.260345966079038d0
         coeffs(3, 1) = 0.260345966079038d0; coeffs(3, 2) = 0.479308067841923d0
         coeffs(4, 1) = 0.260345966079038d0; coeffs(4, 2) = 0.260345966079038d0
         coeffs(5, 1) = 0.869739794195568d0; coeffs(5, 2) = 0.065130102902216d0
         coeffs(6, 1) = 0.065130102902216d0; coeffs(6, 2) = 0.869739794195568d0
         coeffs(7, 1) = 0.065130102902216d0; coeffs(7, 2) = 0.065130102902216d0
         coeffs(8, 1) = 0.638444188569809d0; coeffs(8, 2) = 0.312865496004875d0
         coeffs(9, 1) = 0.638444188569809d0; coeffs(9, 2) = 0.048690315425316d0
         coeffs(10, 1) = 0.312865496004875d0; coeffs(10, 2) = 0.638444188569809d0
         coeffs(11, 1) = 0.312865496004875d0; coeffs(11, 2) = 0.048690315425316d0
         coeffs(12, 1) = 0.048690315425316d0; coeffs(12, 2) = 0.312865496004875d0
         coeffs(13, 1) = 0.048690315425316d0; coeffs(13, 2) = 0.638444188569809d0
      endif

      return

   end subroutine triquad

end module quadrature
